<!--
석고 공차/중량계근 I/F
  -->
<div style="margin:10px 10px 0px 10px">

  <dx-toolbar style="margin:20px 0px 20px 0px">
    <dxi-item location="before" locateInMenu="auto">
      <div *dxTemplate>
        <div style="float:left; margin-left: 10px;">
          <dx-date-box [value]="now"
                       type="date"
                       [disabled]="true"
                       displayFormat="yyyy-MM-dd"
                       applyValueMode="useButtons"
                       label="작업일자">
          </dx-date-box>
        </div>
      </div>
    </dxi-item>

    <dxi-item location="before" locateInMenu="auto">
      <div *dxTemplate>
        <div style="float:left; margin-left: 10px;">
          <dx-date-box #datebox
                       [value]="now"
                       type="time"
                       [disabled]="true"
                       displayFormat="HH:mm:ss"
                       applyValueMode="useButtons"
                       label="현재시간">
          </dx-date-box>
        </div>
      </div>
    </dxi-item>
    <dxi-item location="before"
              widget="dxButton"
              horizontalAlignment="center"
              locateInMenu="center"
              style="margin-right: 5px;">
      <div *dxTemplate style="margin-left:15px;">
        <dx-button stylingMode="contained"
                   text="조회"
                   (onClick)="refreshDataGrid($event)"
                   [width]="100"
                   [height]="25"
                   style="margin-top:3px">
        </dx-button>
      </div>
    </dxi-item>

    <dxi-item location="after"
              locateInMenu="auto"
              style="width: auto;
            margin-right: 5px;">
      <dx-button (onClick)="deleteRecords()"
                 [disabled]="!selectedItemKeys.length"
                 [width]="100"
                 text="삭제">
      </dx-button>
    </dxi-item>

    <dxi-item location="after"
              widget="dxButton"
              locateInMenu="auto"
              style="width: auto;
            margin-right: 5px;">
      <dx-button stylingMode="contained"
                 [(text)]="buttonText"
                 (onClick)="manualRegis($event)"
                 [width]="100"
                 type="normal">
      </dx-button>
    </dxi-item>

    <dxi-item location="after"
              widget="dxButton"
              locateInMenu="auto"
              style="width: auto;
            margin-right: 5px;">
      <dx-button stylingMode="contained"
                 text="계근 시작"
                 type="normal"
                 (onClick)="openComClick($event)"
                 [width]="100">
      </dx-button>
    </dxi-item>
    <dxi-item location="after"
              widget="dxButton"
              locateInMenu="auto"
              style="width: auto;
            margin-right: 5px;">
      <dx-button stylingMode="contained"
                 text="계근 중지"
                 type="normal"
                 (onClick)="closeComClick($event)"
                 [width]="100">
      </dx-button>
    </dxi-item>
  </dx-toolbar>

  <dx-box direction="row" width="100%" style="margin-top: 20px;">
    <dxi-item [ratio]="1" [baseSize]="400">
      <br>※ 등록<br><br>
      <dx-form id="form" name="form" [formData]="weightStartData" [colCount]="1" width="90%">
        <dxi-item itemType="group" caption="" [colCount]="2">
          <dxi-item dataField="STATUS" editorType="dxTextBox" [editorOptions]="{readOnly: true}">
            <dxo-label text="현재 상태"></dxo-label>
          </dxi-item>
        </dxi-item>

        <dxi-item itemType="group" caption="" [colCount]="2">
          <dxi-item dataField="ZGW_DATE" editorType="dxDateBox" [editorOptions]="{ displayFormat: 'yyyy-MM-dd', type: 'date', useMaskBehavior : true}">
            <dxo-label text="발생일자"></dxo-label>
            <dxi-validation-rule type="required" message="발생일자를 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
          <dxi-item dataField="ZGW_TIME" editorType="dxDateBox" [editorOptions]="{ displayFormat: 'HH:mm:ss',type: 'time', useMaskBehavior : true, pickerType: 'rollers'}">
            <dxo-label text="발생시간"></dxo-label>
            <dxi-validation-rule type="required" message="발생시간을 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
        </dxi-item>

        <dxi-item itemType="group" caption="" [colCount]="2">
          <dxi-item dataField="ZCARNO">
            <dxo-label text="차량 번호"></dxo-label>
            <dxi-validation-rule type="required" message="차량 번호를 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
          <dxi-item dataField="ZDRIVER">
            <dxo-label text="운전기사명"></dxo-label>
            <dxi-validation-rule type="required" message="운전기사명을 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
        </dxi-item>
        <dxi-item itemType="group" caption="" [colCount]="2">
          <dxi-item dataField="ZGW_MATNR">
            <dxo-label text="자재코드"></dxo-label>
            <dxi-validation-rule type="required" message="자재코드를 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
          <dxi-item dataField="ZGW_MAKTX">
            <dxo-label text="자재명"></dxo-label>
            <dxi-validation-rule type="required" message="자재명을 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
        </dxi-item>

        <dxi-item itemType="group" caption="" [colCount]="2">
          <dxi-item dataField="ZGW_LIFNR">
            <dxo-label text="업체코드"></dxo-label>
            <dxi-validation-rule type="required" message="업체코드를 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
          <dxi-item dataField="ZGW_NAME1">
            <dxo-label text="업체명"></dxo-label>
            <dxi-validation-rule type="required" message="업체명을 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
        </dxi-item>

        <dxi-item itemType="group" caption="">

          <dxi-item dataField="ZGW_ATGEW" editorType="dxNumberBox" id="numberbox" [editorOptions]="{ height: 40, disabled:true}" #testBox>
            <dxo-label text="계근 중량"></dxo-label>
            <dxi-validation-rule type="required" message="계근 중량을 입력해주십시오."></dxi-validation-rule>
          </dxi-item>

          <dxi-item dataField="GEWEI" editorType="dxTextBox">
            <dxo-label text="중량단위"></dxo-label>
            <dxi-validation-rule type="required" message="중량단위를 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
        </dxi-item>

        <dxi-item itemType="group" caption="">
          <dxi-item dataField="ZGW_PER1">
            <dxo-label text="검량자"></dxo-label>
            <dxi-validation-rule type="required" message="검량자를 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
        </dxi-item>
        <dxi-item itemType="group" caption="">
          <dxi-item dataField="ZGW_PER2">
            <dxo-label text="확인자"></dxo-label>
            <dxi-validation-rule type="required" message="확인자를 입력해주십시오."></dxi-validation-rule>
          </dxi-item>
        </dxi-item>

        <dxi-item itemType="group" [colCount]="4" [colSpan]="3">

          <dxi-item itemType="button"
                    widget="dxButton"
                    location="before"
                    [buttonOptions]="weightStatementOutput">
          </dxi-item>

          <dxi-item itemType="button"
                    widget="dxButton"
                    location="before"
                    [buttonOptions]="weightEnterRegister">
          </dxi-item>
          <dxi-item itemType="button"
                    widget="dxButton"
                    location="before"
                    [buttonOptions]="weightOutRegister">
          </dxi-item>

        </dxi-item>
        </dx-form>
      <dx-form>
        <dxi-item>
          <br><br>※ 계근대를 통한 입출고 관리<br><br>
          <dx-data-grid class="dx-card wide-card"
                        #subdataGrid
                        [dataSource]="subData"
                        [showBorders]="false"
                        [focusedRowEnabled]="true"
                        [focusedRowIndex]="0"
                        [columnAutoWidth]="true"
                        [allowColumnResizing]="true"
                        [repaintChangesOnly]="true"
                        [remoteOperations]="true"
                        [columnResizingMode]="columnResizeMode"
                        [columnHidingEnabled]="true"
                        [allowColumnReordering]="true"
                        (onSelectionChanged)="selectionChanged($event)"
                        [selection]="{ mode: 'multiple' }"
                        height="300px">

            <!--Datagrid Option-->
            <dxo-paging [enabled]="false"></dxo-paging>
            <dxo-pager [showPageSizeSelector]="true" [showInfo]="true"></dxo-pager>

            <!--Filtering Option-->
            <dxo-filter-panel [visible]="true"></dxo-filter-panel>
            <dxo-filter-builder [customOperations]="customOperations"
                                [allowHierarchicalFields]="true">
            </dxo-filter-builder>
            <dxo-filter-builder-popup [position]="popupPosition">
            </dxo-filter-builder-popup>
            <dxo-filter-row [visible]="true"></dxo-filter-row>
            <dxo-header-filter [visible]="true"></dxo-header-filter>
            <dxo-scrolling columnRenderingMode="virtual"></dxo-scrolling>

            <!--Data column-->
            <dxi-column dataField="ZGW_GUBUN"
                        caption="계근대구분">
            </dxi-column>
            <dxi-column dataField="ZGW_GRIR_GUBUN"
                        caption="입출고구분">
            </dxi-column>
            <dxi-column dataField="ZGW_DATE"
                        dataType="date"
                        alignment="center"
                        format="yyyy-MM-dd"
                        caption="발생일">
            </dxi-column>
            <dxi-column dataField="ZGW_SEQ"
                        sortOrder="asc"
                        caption="순번">
            </dxi-column>
            <dxi-column dataField="ZCARNO"
                        caption="차량번호">
            </dxi-column>
            <dxi-column dataField="TDLNR1"
                        caption="운송업체">
            </dxi-column>
            <dxi-column dataField="ZGW_MATNR"
                        alignment="center"
                        caption="자재코드">
            </dxi-column>
            <dxi-column dataField="ZGW_MAKTX"
                        caption="자재명">
            </dxi-column>
            <dxi-column dataField="ZGW_LIFNR"
                        alignment="center"
                        caption="업체코드">
            </dxi-column>
            <dxi-column dataField="ZGW_NAME1"
                        caption="업체명">
            </dxi-column>
            <dxi-column dataField="ZGW_BRGEW"
                        caption="총중량"
                        format="#,###">
            </dxi-column>
            <dxi-column dataField="ZGW_NTGEW"
                        caption="공차중량"
                        format="#,###">
            </dxi-column>
            <dxi-column dataField="ZGW_ATGEW"
                        caption="실중량"
                        format="#,###">
            </dxi-column>
            <dxi-column dataField="ZGW_ATGEW_P"
                        caption="SAP처리수량">
            </dxi-column>
            <dxi-column dataField="ZGW_GR_TIME"
                        dataType="time"
                        alignment="center"
                        format="HH:mm:ss"
                        caption="입문시간">
            </dxi-column>
            <dxi-column dataField="ZGW_GI_TIME"
                        dataType="time"
                        alignment="center"
                        format="HH:mm:ss"
                        caption="출문시간">
            </dxi-column>
            <dxi-column dataField="ZPOST_RUN_MESSAGE"
                        caption="자동전기오류메시지">
            </dxi-column>
            <dxi-column dataField="MBLNR"
                        caption="자재문서번호">
            </dxi-column>
          </dx-data-grid>
        </dxi-item>
      </dx-form>

    </dxi-item>
    <dxi-item [ratio]="1" [baseSize]="500">

      <div *dxTemplate="let data of 'content'" style="margin-top:20px; ">
        ※ 계근대를 통한 입고관리<br><br>
        <dx-data-grid class="dx-card wide-card"
                      id="maindataGrid"
                      name="maindataGrid"
                      #maindataGrid
                      [dataSource]="mainData"
                      [showBorders]="false"
                      [focusedRowEnabled]="true"
                      [focusedRowIndex]="0"
                      [columnAutoWidth]="true"
                      [allowColumnResizing]="true"
                      [remoteOperations]="true"
                      [columnResizingMode]="columnResizeMode"
                      [repaintChangesOnly]="true"
                      [columnHidingEnabled]="true"
                      [allowColumnReordering]="true"
                      (onSelectionChanged)="selectionChanged($event)"
                      [selection]="{ mode: 'multiple' }"
                      height="calc(90vh - 155px)">

          <!--Datagrid Option-->
          <dxo-paging [enabled]="false"></dxo-paging>
          <dxo-pager [showPageSizeSelector]="true" [showInfo]="true"></dxo-pager>

          <!--Filtering Option-->
          <dxo-filter-panel [visible]="true"></dxo-filter-panel>
          <dxo-filter-builder [customOperations]="customOperations"
                              [allowHierarchicalFields]="true">
          </dxo-filter-builder>
          <dxo-filter-builder-popup [position]="popupPosition">
          </dxo-filter-builder-popup>
          <dxo-filter-row [visible]="true"></dxo-filter-row>
          <dxo-header-filter [visible]="true"></dxo-header-filter>
          <dxo-scrolling columnRenderingMode="virtual"></dxo-scrolling>

          <!--Data column-->
          <dxi-column dataField="ZGW_GUBUN"
                      caption="계근대구분">
          </dxi-column>
          <dxi-column dataField="ZGW_DATE"
                      dataType="date"
                      alignment="center"
                      format="yyyy-MM-dd"
                      caption="발생일자">
          </dxi-column>
          <dxi-column dataField="ZGW_TIME"
                      dataType="time"
                      alignment="center"
                      format="HH:mm:ss"
                      caption="발생시간">
          </dxi-column>

          <dxi-column dataField="ZCARNO"
                      caption="차량번호">
          </dxi-column>
          <dxi-column dataField="ZDRIVER"
                      caption="운송업체">
          </dxi-column>
          <dxi-column dataField="ZGW_MATNR"
                      alignment="center"
                      caption="자재코드">
          </dxi-column>
          <dxi-column dataField="ZGW_MAKTX"
                      caption="자재명">
          </dxi-column>
          <dxi-column dataField="ZGW_LIFNR"
                      alignment="center"
                      caption="업체코드">
          </dxi-column>
          <dxi-column dataField="ZGW_NAME1"
                      caption="업체명">
          </dxi-column>
          <dxi-column dataField="ZGW_ATGEW"
                      caption="계측중량"
                      format="#,###">
          </dxi-column>
          <dxi-column dataField="GEWEI"
                      alignment="center"
                      caption="중량단위">
          </dxi-column>
          <dxi-column dataField="ZGW_PER1"
                      caption="검량자">
          </dxi-column>
          <dxi-column dataField="ZGW_PER2"
                      caption="확인자">
          </dxi-column>
          <dxi-column dataField="ZGW_ORDNO"
                      caption="주문번호(출하요청)">
          </dxi-column>
          <dxi-column dataField="ZGW_SHIPNO"
                      caption="배차번호">
          </dxi-column>
          <dxi-column dataField="ZGW_DONO"
                      caption="출하번호">
          </dxi-column>
        </dx-data-grid>
      </div>
    </dxi-item>
  </dx-box>

</div>
